import{A as e,f as l,p as i,a as t,r,o as s,c as a,b as o,t as n,F as c,e as u,j as p,B as d,C as m,w as f,h,d as g}from"./index.a9dbc9b5.js";import"./index.bc823562.js";import"./vendor.e7098c4c.js";const y="https://peng-xiao-shuai-0902.github.io/vite-vue-admin/",b={props:{value:String,limit:{default:1,type:Number},tipLabel:{default:"支持格式jpg、jpeg、png",type:String},fileType:{default:0,type:[Number,String]},type:{default:0,type:[Number,String]},fileSize:{type:[Number,String],default:1},disabled:{type:Boolean,default:!1},suffixStr:{type:[Array,String],default:()=>["jpg、jpeg、png","mp4、ogg、flv、avi、wmv、rmvb、mov","pdf、txt、doc、docx、excel、ppt"]}},data:()=>({icon:"",imgArr:[],nameArr:[],deleteUrl:y+"admin/file/delete",uploadPercent:0,percentFlag:!1,multiple:!1,uploadUrl:y+e}),emits:["update:value"],methods:{onError(e,l){console.log(e,l),this.$message({message:"上传失败",type:"danger"}),this.percentFlag=!1,this.icon=""},onProgress(e,l){this.icon="el-icon-loading",this.uploadPercent=Number(l.percentage.toFixed(2)),this.percentFlag=!0},beforeUpload(e){if(this.imgArr.length>=this.limit)return this.$message.warning("超出最大上传数量"+this.limit+"！"),!1;let l=this.fileSize;if(console.log(e.size/1024/1024),""!=l&&e.size/1024/1024>=l)return this.$message({message:"文件大小不能超过"+this.fileSize+"MB",type:"warning"}),!1;let i=2!=this.fileType?e.type.lastIndexOf("/"):e.name.lastIndexOf("."),t=2!=this.fileType?e.type.substr(i+1,e.type.length):e.name.substr(i+1,e.name.length);console.log(t);let r="object"==typeof this.suffixStr?this.suffixStr[this.fileType]:this.suffixStr;return console.log(r,r.match(t)),r.match(t)?(this.$message.success("上传成功，仅为测试"),console.log("上传成功，未调用接口"),!1):(this.$message.warning("只能上传"+r+"的文件"),!1)},handleSuccess(e){200==e.code?(this.uploadPercent=100,setTimeout((()=>{this.percentFlag=!1,this.imgArr.push(e.data.url),this.nameArr.push(e.data.name),this.icon="",this.uploadPercent=0,console.log("上传成功",this.imgArr.join(",")),this.$emit("update:value",this.imgArr.join(","))}),400)):this.$message.error("上传失败！")},onExceed(e){this.$message.warning("超出最大上传数量"+this.limit+"！")},Remove(e){this.imgArr.splice(e,1),this.nameArr.splice(e,1),this.$refs.upload.uploadFiles.splice(e,1),this.$emit("update:value",this.imgArr.join(",")),this.$message.success("删除成功！")},flieEcho(e){if(2!=this.fileType)return;let i=e.substr(e.lastIndexOf("/")+1,e.length);this.$nextTick((()=>{this.$refs.upload.uploadFiles=l([{name:i,percentage:100,status:"success"}])}))},clearFiles(){}},watch:{value:{handler(e,l){if("string"==typeof e&&e){if(this.flieEcho(e),""!=e){this.imgArr=e.split(",");for(let e of this.imgArr)this.flieEcho(e)}}else this.imgArr=[],0==this.imgArr.length&&this.$refs.upload&&(this.$refs.upload.uploadFiles=[])},immediate:!0}}},v=f();i("data-v-17856820");const x={style:{display:"flex"}},F=h("上传"),S={class:"el-upload__tip"},A={class:"imgArr"};t();const w=v(((e,l,i,t,f,h)=>{const g=r("el-button"),y=r("el-upload"),b=r("el-image"),w=r("el-progress");return s(),a("div",null,[o("div",x,[o(y,{class:"upload-demo",ref:"upload","on-progress":h.onProgress,"show-file-list":2==i.fileType,"on-success":h.handleSuccess,"on-exceed":h.onExceed,"on-error":h.onError,limit:i.limit,multiple:i.limit>1,action:f.uploadUrl,"before-upload":h.beforeUpload,disabled:""!=f.icon||i.disabled},{tip:v((()=>[o("div",S,n(i.tipLabel),1)])),default:v((()=>[o(g,{icon:f.icon,type:"primary",disabled:""!=f.icon},{default:v((()=>[F])),_:1},8,["icon","disabled"])])),_:1},8,["on-progress","show-file-list","on-success","on-exceed","on-error","limit","multiple","action","before-upload","disabled"])]),o("div",A,[0!=f.imgArr.length&&0==i.fileType?(s(!0),a(c,{key:0},u(f.imgArr,((e,l)=>(s(),a("div",{class:"item",key:l},[o("i",{class:"el-icon-circle-close position",onClick:e=>h.Remove(l)},null,8,["onClick"]),o(b,{lazy:!0,fit:"fill",style:{width:"100px"},src:e,"preview-src-list":[e]},null,8,["src","preview-src-list"])])))),128)):p("",!0),0!=f.imgArr.length&&1==i.fileType?(s(!0),a(c,{key:1},u(f.imgArr,((e,l)=>(s(),a("div",{class:"item",key:l},[o("i",{class:"el-icon-circle-close position",onClick:e=>h.Remove(l)},null,8,["onClick"]),o("video",{src:e,style:{width:"100px",height:"100px"},class:"avatar video-avatar",controls:"controls"}," 您的浏览器不支持视频播放 ",8,["src"])])))),128)):p("",!0),0!=f.imgArr.length&&2==i.fileType?(s(),a(c,{key:2},[],64)):p("",!0),d(o(w,{type:"circle",width:100,percentage:f.uploadPercent,style:{"margin-top":"7px"}},null,8,["percentage"]),[[m,f.percentFlag]])])])}));b.render=w,b.__scopeId="data-v-17856820";var T=g({components:{uploadFilesCopy:b},setup:()=>({currentFrom:l({image:"http://www.aiiup.cn/uploads/20190821/1-1Z115223503326.jpg",limit:1,fileType:0,fileSize:1,suffixStr:"jpg、jpeg、png",suffixArr:[{label:"图片",type:0},{label:"视频",type:1},{label:"文件",type:2}]})})});const j=f();i("data-v-1b24bf9c");const z={class:"app-container"},$=o("div",{class:"operate-container"},[o("div",null,[o("i",{class:"viteIcon viteZJ-shangchuan",style:{"margin-right":"5px"}}),o("span",null,"上传文件（图片、视频）")])],-1),_={class:"screenForm"},V={style:{display:"flex","justify-content":"center","margin-top":"20px"}};t();const k=j(((e,l,i,t,n,p)=>{const d=r("el-input-number"),m=r("el-form-item"),f=r("el-option"),h=r("el-select"),g=r("el-input"),y=r("el-form"),b=r("upload-files-copy"),v=r("el-card");return s(),a("div",z,[o(v,{shadow:e.defalutData.cardShadow},{default:j((()=>[$,o("div",null,[o("div",null,[o(y,{inline:!0,model:e.currentFrom},{default:j((()=>[o("div",_,[o(m,{label:"最大上传数量："},{default:j((()=>[o(d,{modelValue:e.currentFrom.limit,"onUpdate:modelValue":l[1]||(l[1]=l=>e.currentFrom.limit=l),placeholder:"请输入最大上传数量",style:{width:"80%"},clearable:""},null,8,["modelValue"])])),_:1}),o(m,{label:"上传类型："},{default:j((()=>[o(h,{modelValue:e.currentFrom.fileType,"onUpdate:modelValue":l[2]||(l[2]=l=>e.currentFrom.fileType=l),placeholder:"请选择",style:{width:"80%"}},{default:j((()=>[(s(!0),a(c,null,u(e.currentFrom.suffixArr,(e=>(s(),a(f,{key:e.type,label:e.label,value:e.type},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),o(m,{label:"最大上传文件大小（MB）："},{default:j((()=>[o(g,{modelValue:e.currentFrom.fileSize,"onUpdate:modelValue":l[3]||(l[3]=l=>e.currentFrom.fileSize=l),placeholder:"请输入最大上传文件大小",style:{width:"80%"},clearable:""},null,8,["modelValue"])])),_:1}),o(m,{label:"上传"+e.currentFrom.suffixArr[e.currentFrom.fileType].label+"类型（、）隔开："},{default:j((()=>[o(g,{modelValue:e.currentFrom.suffixStr,"onUpdate:modelValue":l[4]||(l[4]=l=>e.currentFrom.suffixStr=l),placeholder:"请输入上传"+e.currentFrom.suffixArr[e.currentFrom.fileType].label+"格式",style:{width:"80%"},clearable:""},null,8,["modelValue","placeholder"])])),_:1},8,["label"])])])),_:1},8,["model"])]),o("div",V,[o(b,{value:e.currentFrom.image,"onUpdate:value":l[5]||(l[5]=l=>e.currentFrom.image=l),"fileSize:":e.currentFrom.fileSize,limit:e.currentFrom.limit,fileType:e.currentFrom.fileType,fileSize:e.currentFrom.fileSize,suffixStr:e.currentFrom.suffixStr,tipLabel:"最大上传数量为"+e.currentFrom.limit+"，只能上传"+e.currentFrom.suffixStr+"，且文件大小不超过"+e.currentFrom.fileSize},null,8,["value","fileSize:","limit","fileType","fileSize","suffixStr","tipLabel"])])])])),_:1},8,["shadow"])])}));T.render=k,T.__scopeId="data-v-1b24bf9c";export default T;
