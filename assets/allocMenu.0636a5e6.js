import{f as e}from"./menu.de2a863a.js";import{l as t,e as a}from"./role.82e24538.js";import{q as r,v as s,r as n,o as d,c as l,a as o,A as i,k as h}from"./vendor.3c20cdd8.js";import"./index.4e0d8f0d.js";const c={name:"allocMenu",data:()=>({menuTreeList:[],defaultProps:{children:"children",label:"title"},roleId:null}),created(){this.roleId=this.$route.query.roleId,this.treeList(),this.getRoleMenu(this.roleId)},methods:{treeList(){e().then((e=>{this.menuTreeList=e.data}))},getRoleMenu(e){t(e).then((e=>{let t=e.data,a=[];if(null!=t&&t.length>0)for(let r=0;r<t.length;r++){let e=t[r];0!==e.parentId&&a.push(e.id)}this.$refs.tree.setCheckedKeys(a)}))},handleSave(){let e=this.$refs.tree.getCheckedNodes(),t=new Set;if(null!=e&&e.length>0)for(let a=0;a<e.length;a++){let r=e[a];t.add(r.id),0!==r.parentId&&t.add(r.parentId)}this.$confirm("是否分配菜单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let e=new FormData;e.append("roleId",this.roleId),e.append("menuIds",Array.from(t)),a(e).then((e=>{this.$message({message:"分配成功",type:"success",duration:1e3}),this.$router.back()}))}))},handleClear(){this.$refs.tree.setCheckedKeys([])}}},u=i("data-v-2a1e44cc");r("data-v-2a1e44cc");const p={style:{"margin-top":"20px"},align:"center"},f=h("保存"),m=h("清空");s();const g=u(((e,t,a,r,s,i)=>{const h=n("el-tree"),c=n("el-button"),g=n("el-card");return d(),l(g,{class:"form-container",shadow:"never"},{default:u((()=>[o(h,{data:s.menuTreeList,"show-checkbox":"","default-expand-all":"","node-key":"id",ref:"tree","highlight-current":"",props:s.defaultProps},null,8,["data","props"]),o("div",p,[o(c,{type:"primary",onClick:t[1]||(t[1]=e=>i.handleSave())},{default:u((()=>[f])),_:1}),o(c,{onClick:t[2]||(t[2]=e=>i.handleClear())},{default:u((()=>[m])),_:1})])])),_:1})}));c.render=g,c.__scopeId="data-v-2a1e44cc";export default c;
